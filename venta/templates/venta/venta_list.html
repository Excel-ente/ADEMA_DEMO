{% extends 'core/base.html' %}

{% block content %}

<div class="container">
    <div class="" style="text-align: start;">
        <h1 class="text-light p-3" style="margin-top: 70px;"><b></b></h1>
    </div>
    <div class="card p-3 d-flex">   
        
        <div class="row justify-content-center">
            <div class="div col-4">
                <div class="card" style="border: none;">
                    <div class="card-body text-center">
                        <div>
                            <h4 class="text-primary"><label for="">Buscar por fecha</label></h4>
                        </div>
                        <div>
                            <input type="date" id="fecha" class="form-control">
                        </div>
                    </div>
                </div>
            </div>
            <div class="div col-4">
                <div class="card" style="border: none;">
                    <div class="card-body">
                        <h4 class="text-primary">Total hoy</h4>
                        <h4 class="text-danger"><b>$ {{ total_hoy }}</b></h4>
                    </div>
                </div>
            </div>
            <div class="div col-4">
                <div class="card" style="border: none;">
                    <div class="card-body">
                        <h4 class="text-primary">Total Mes ({{ mes }})</h4>
                        <h4 class="text-danger"><b>$ {{ total_mes }}</b></h4>
                    </div>
                </div>
            </div>
        </div>

        <div class="card-body">
            <div class="mt-5 row">
                {% for venta in venta_list %}
                    {% if venta.detalleventa_set.all %}
                        <div class="col-sm-6 col-md-5 col-lg-3 py-2">
                            <div class="card mr-2">
                                <div class="card-header bg-primary">
                                    <a href="{% url 'venta:detail' venta.id %}">
                                        <p class="card-title d-inline">
                                            <i class="fa fa-shopping-cart text-white" style="font-size: 1.2em;"></i>
                                            <span class="float-right text-white">CÃ³digo: {{ venta.codigo }}</span>
                                        </p>
                                    </a>
                                </div>
                                <div class="card-body">
                                    <h6 class="card-subtitle mb-2 text-muted">Fecha: {{ venta.get_date }}</h6>
                                    <p class="font-weight-bold mt-4" style="color: #3c3c3c;">Cantidad de productos:
                                    <span class="secondary">{{ venta.get_cart_items }}</span></p>
                                    <p class="font-weight-bold mt-4" style="color: #3c3c3c;">Total de venta: $.
                                    <span class="secondary">{{ venta.get_cart_total }}</span></p>
                                    
                                    <div class="d-flex">
                                        {% if not venta.estado == venta.ESTADO_ANULADA and not venta.estado == venta.ESTADO_CANCELADA %}
                                            <div class="col">
                                            {% if venta.estado == venta.ESTADO_CREADA %}
                                                <a class="btn btn-danger" style="margin: 15px;"
                                                href="{% url 'venta:anular' venta.id %}">Cancelar</a>
                                            {% else %}
                                                <a class="btn btn-danger" style="margin: 15px;"
                                                href="{% url 'venta:anular' venta.id %}">Anular</a>
                                            {% endif %}
                                            </div>
                                            <div class="col">
                                            <a class="btn btn-success" style="margin: 15px;"
                                            href="{% url 'venta:anular' venta.id %}">Imprimir</a>
                                            </div>
                                        {% endif %}
                                    </div>

                                </div>

                                <div class="card-footer" style="background-color: rgba(26, 188, 156,0.2);">
                                    <div class="row">
                                        <div class="col">
                                            <p class="btn">Estado: {{ venta.get_estado_display }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>    

    </div>
</div>
{% endblock %}